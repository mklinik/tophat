% !TEX root=pldi2019.tex


%% Language %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newmacro{G-Language}{
  \begin{grammar}
    Expressions
      & e    &::= & \lambda x:\tau.\ e   & – abstraction \\
      &      &\mid& e_1\ e_2             & – application \\
      &      &\mid& x                    & – variable \\
      &      &\mid& c                    & – constant \\
    \addlinespace
      &      &\mid& e_1 \star e_2        & – operation \\
      &      &\mid& \If{e_1}{e_2}{e_3}   & – branch \\
      &      &\mid& \tuple{e_1, e_2}     & – pair \\
      &      &\mid& \Fst e               & – first projection \\
      &      &\mid& \Snd e               & – second projection \\
      &      &\mid& \unit                & – unit \\
    \addlinespace
      &      &\mid& \Ref e               & – reference \\
      &      &\mid& !e                   & – dereference \\
      &      &\mid& e_1 := e_2           & – assignment \\
      % &      &\mid& e_1; e_2             & – sequence \\
      &      &\mid& l                    & – location \\
    \addlinespace
      &      &\mid& p                    & – pretask \\
    \addlinespace
    Constants
      & c    &::= & B                    & – boolean \\
      &      &\mid& I                    & – integer \\
      &      &\mid& S                    & – string
  \end{grammar}
}

\newmacro{G-Language-Compact}{
  \begin{grammar*}
    e ::= &                                              & Expressions \\
    \mid  & \lambda x:\tau.\ e  \Mid  e_1\ e_2           & – abstraction, application \\
    \mid  & x  \Mid  c  \Mid  e_1 \star e_2              & – variable, constant, operation \\
    \mid  & \If{e_1}{e_2}{e_3}  \Mid  \unit              & – branch, unit \\
    \mid  & \tuple{e_1, e_2}  \Mid  \Fst e  \Mid  \Snd e & – pair, projections \\
    \mid  & \Ref e  \Mid  !e  \Mid  e_1 := e_2  \Mid  l  & – references, location \\
    \mid  & p                                            & – pretask \\
    c ::= &                                              & Constants \\
    \mid  & B  \Mid  I  \Mid  S                          & – boolean, integer, string
  \end{grammar*}
}

\newmacro{G-Pretasks}{
  \begin{grammar}
    Pretasks
      & p    &::= & \Edit e              & – valued editor \\
      &      &\mid& \Enter \tau          & – unvalued editor \\
      &      &\mid& \Update e            & – shared editor \\
    \addlinespace
      &      &\mid& e_1 \Then e_2        & – step \\
      &      &\mid& e_1 \Next e_2        & – user step \\
    \addlinespace
      &      &\mid& e_1 \And e_2         & – composition \\
    \addlinespace
      &      &\mid& e_1 \Or e_2          & – choice \\
      &      &\mid& e_1 \Xor e_2         & – user choice \\
    \addlinespace
      &      &\mid& u \At e              & – appoint \\
      &      &\mid& \Fail                & – fail task
  \end{grammar}
}

\newmacro{G-Pretasks-Compact}{
  \begin{grammar*}
    p ::= &                                              & Pretasks \\
    \mid  & \Edit e \Mid   \Enter \tau  \Mid   \Update e & – editors: valued, unvalued, shared \\
    \mid  & e_1 \Then e_2 \Mid   e_1 \Next e_2           & – steps: system, user \\
    \mid  & e_1 \And e_2                                 & – pairing \\
    \mid  & e_1 \Or e_2 \Mid   e_1 \Xor e_2              & – choice: system, user \\
    \mid  & \Fail                                        & – fail
  \end{grammar*}
}

\newmacro{G-Types}{
  \begin{grammar}
    Types
      & \tau &::= & \tau_1 \to \tau_2    & – function type \\
      &      &\mid& \tau_1 \times \tau_2 & – product type \\
      &      &\mid& \Unit                & – unit type \\
      &      &\mid& \Reference \tau      & – reference type \\
      &      &\mid& \Task \tau           & – task type \\
      &      &\mid& \beta                & – basic type \\
      % &      &\mid& \alpha               & – universal type \\
    Basic types
      &\beta &::= & \Bool                & – boolean type \\
      &      &\mid& \Int                 & – integer type \\
      &      &\mid& \String              & – string type \\
  \end{grammar}
}

\newmacro{G-Types-Compact}{
  \begin{grammar*}
    \tau ::=  &                                                        & Types \\
    \mid      & \tau_1 \to \tau_2 \Mid \tau_1 \times \tau_2 \Mid \beta & – function, product, basic \\
    \mid      & \Unit \Mid \Reference \tau \Mid \Task \tau             & – unit, reference, task \\
    \beta ::= &                                                        & Basic types \\
    \mid      & \Bool \Mid   \Int \Mid   \String                       & – boolean, integer, string
  \end{grammar*}
}

\newmacro{G-Values}{
  \begin{grammar}
    Values
      & v    &::= & \lambda x:\tau.\ e   & – abstraction \\
      &      &\mid& \tuple{v_1, v_2}     & – pair value \\
      &      &\mid& \unit                & – unit \\
      &      &\mid& c                    & – constant \\
      &      &\mid& l                    & – location \\
      &      &\mid& t                    & – task \\
    Tasks
      & t    &::= & \Edit v              & – valued editor \\
      &      &\mid& \Enter \tau          & – unvalued editor \\
      &      &\mid& \Update l            & – shared editor \\
      &      &\mid& \Fail                & – fail task \\
      &      &\mid& t_1 \Then e_2        & – step \\
      &      &\mid& t_1 \Next e_2        & – user step \\
      &      &\mid& t_1 \And t_2         & – composition \\
      &      &\mid& t_1 \Or t_2          & – choice \\
      &      &\mid& t_1 \Xor t_2         & – user choice
  \end{grammar}
}

\newmacro{G-Values-Compact}{
  \begin{grammar*}
    v ::= &                                                     & Values \\
      \mid& \lambda x:\tau.\ e \Mid \tuple{v_1, v_2} \Mid \unit & – abstraction, pair, unit \\
      \mid& c \Mid l \Mid t                                     & – constant, location, task \\
    t ::= &                                                     & Tasks \\
      \mid& \Edit v \Mid \Enter \tau \Mid \Update l             & – editors \\
      \mid& t_1 \Then e_2 \Mid t_1 \Next e_2                    & – steps \\
      \mid& t_1 \And t_2                                        & – composition \\
      \mid& t_1 \Or t_2 \Mid e_1 \Xor e_2                       & – choices \\
      \mid& u @ t \Mid \Fail                                    & – appoint, fail
  \end{grammar*}
}

\newmacro{G-Inputs}{
  \begin{grammar}
    Inputs
      & i    & ::=& a                    & – action \\
      &      &\mid& \First i             & – pass to first \\
      &      &\mid& \Second i            & – pass to second \\
    Actions
      & a    & ::=& v                    & – change editor to value \\
      &      &\mid& \Empty               & – empty an editor \\
      &      &\mid& \Continue            & – continue with next task \\
      &      &\mid& \Pick                & – pick route \\
    Routes
      & r    & ::=& \Left                & – go left \\
      &      &\mid& \Right               & – go right \\
  \end{grammar}
}

\newmacro{G-Inputs-Compact}{
  \begin{grammar*}
    %j ::= &                                           & Maybe Appointed Inputs\\
    %\mid  & u\At i \Mid i                             & – assigned input, input\\
    i ::= &                                           & Inputs \\
    \mid  & a \Mid \First i \Mid \Second i            & – action, pass to first, pass to second \\
    a ::= &                                           & Actions \\
    \mid  & v \Mid \Empty \Mid \Continue              & – change, empty, continue\\
    \mid  & \Left \Mid \Right                         & – go left, go right
  \end{grammar*}
}
