% !TEX root=../report.tex

\section{Side-by-side composition}

\begin{grammar}
  Expressions
    & e    & ::=& \ldots               & \\
    &      &\mid& \tuple{e_1, e_2}     & – pairs \\
  Values
    & v    & ::=& \ldots               & \\
    &      &\mid& \tuple{v_1, v_2}     & – pair value \\
  Pretasks
    & p    & ::=& \ldots               & \\
    &      &\mid& e_1 \And e_2         & – task pairing \\
  Tasks
    & t    & ::=& \ldots               & \\
    &      &\mid& t_1 \And t_2         & – task pairing \\
  Types
    & \tau & ::=& \ldots               & \\
    &      &\mid& \tau_1 \times \tau_2 & – product type \\
  Inputs
    & i    & ::=& a                    & – action \\
    &      &\mid& \First i             & – pass to first \\
    &      &\mid& \Second i            & – pass to second \\
\end{grammar}

\begin{equation*}
  \userule{T-And}
\end{equation*}

\begin{equation*}
  \userule{E-And}
\end{equation*}

\begin{equation*}
  \userule{N-And}
\end{equation*}

\begin{equation*}
  \begin{array}{lcl}
    \Value(t_1 \And t_2) &=& \left\{
      \begin{array}{ll}
        \tuple{v_1, v_2} & \when\ \Value(t_1) = v_1 \land \Value(t_2) = v_2 \\
        \bot             & \otherwise
      \end{array}
    \right.
  \end{array}
\end{equation*}

\begin{equation*}
  \begin{array}{lcl}
    \Failing(t_1 \And t_2) &=& \Failing(t_1) \lor \Failing(t_2)
  \end{array}
\end{equation*}

\begin{margintext}{Aside: Pairing in iTasks}
  $\And$ is similar to \type{-\&\&-}.
\end{margintext}

\begin{equation*}
  \userule{H-FirstAnd} \qquad \userule{H-SecondAnd}
\end{equation*}

% The rule \refrule{N-AndEval} covers the other three cases and makes sure both $t_1$ and $t_2$ will be normalised towards a value as much as possible.


\subsection{Intermezzo: monoidal functor and its laws}

\begin{equation*}
  \begin{array}{rclr}
    \Map \Snd\ (\Edit \unit \And t)
      &\approxeq& t
      & \text{(left identity)} \\
    \Map \Fst\ (t \And \Edit \unit)
      &\approxeq& t
      & \text{(right identity)} \\
    \Map \Assoc\ (r \And\ (s \And t))
      &\approxeq& (r \And s) \And t
      & \text{(associativity)} \\
    \Map\ (\lambda \tuple{x, y}. \tuple{g\ x, h\ y})\ (s \And t)
      &\approxeq& \Map\ g\ s \And \Map\ h\ t
      & \text{(naturality)} \\
  \end{array}
\end{equation*}


\subsection{Example: ...}
